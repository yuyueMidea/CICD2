import{n as y,a as m,b as n,p,s as v,h as b,t as x,q as k,o as g}from"./vendor-Dl_ZJaQE.js";const S=async()=>await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),D=async c=>{const a=await crypto.subtle.exportKey("raw",c);return btoa(String.fromCharCode(...new Uint8Array(a)))},C=async(c,a)=>{const o=crypto.getRandomValues(new Uint8Array(12)),r=new TextEncoder().encode(JSON.stringify(a)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:o},c,r),l=new Uint8Array(o.length+s.byteLength);return l.set(o,0),l.set(new Uint8Array(s),o.length),btoa(String.fromCharCode(...l))},f=async(c,a)=>{const o=atob(a),r=new Uint8Array(o.length);for(let e=0;e<o.length;e++)r[e]=o.charCodeAt(e);const s=r.slice(0,12),l=r.slice(12),u=await crypto.subtle.decrypt({name:"AES-GCM",iv:s},c,l);return JSON.parse(new TextDecoder().decode(u))},A={class:"p-5"},U={class:"border"},_={class:"p-5"},E={class:"p-5"},h={class:"p-5"},V={class:"p-5"},B={class:"inline w-500"},T={__name:"CryptoPage",setup(c){const a=y("Alice"),o=y("alice@example.com"),r=y("sensitive-auth-token"),s=y(null),l=async()=>{try{s.value=await S();const e=await D(key);console.log(77,{keyStr:e});const t={name:a.value,email:o.value,token:r.value};console.log(s.value,"keyStr_: ",t);const d=await C(s.value,t);localStorage.setItem("encryptedUserData",d),console.log("加密数据已存储")}catch(e){console.error("加密失败:",e)}},u=async()=>{try{const e=localStorage.getItem("encryptedUserData");if(e){const t=await f(s.value,e);console.log("解密结果:",t)}}catch(e){console.error("解密失败:",e)}};return(e,t)=>{const d=k("track"),w=k("permission");return g(),m("div",A,[t[8]||(t[8]=n("h1",null,"前端对用户信息加密与解密",-1)),n("div",U,[n("p",_,[t[3]||(t[3]=n("span",{class:"inline w-100"},"username",-1)),p(n("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>a.value=i),class:"border p-5 m-5"},null,512),[[v,a.value]])]),n("p",E,[t[4]||(t[4]=n("span",{class:"inline w-100"},"email",-1)),p(n("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=i=>o.value=i),class:"border p-5 m-5"},null,512),[[v,o.value]])]),n("p",h,[t[5]||(t[5]=n("span",{class:"inline w-100"},"token",-1)),p(n("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=i=>r.value=i),class:"border p-5 m-5"},null,512),[[v,r.value]])]),n("p",V,[p((g(),m("button",{class:"btn",onClick:l},t[6]||(t[6]=[b("加密")]))),[[d,"cryptoBtn",void 0,{click:!0}],[w,"admin"]]),p((g(),m("button",{class:"btn",onClick:u},t[7]||(t[7]=[b("解密")]))),[[d,"cryptoBtn",void 0,{click:!0}],[w,"admin"]]),n("span",B,x(s.value),1)])])])}}};export{T as default};
